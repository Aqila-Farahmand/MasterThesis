workflow_name,run_id,run_status,run_conclusion,commit_id,commit_message,commit_author,commit_date,commit_size,files_changed,pull_request_id,pull_request_title,pull_request_author,pull_request_created_at,Pull_request_label,pull_request_body,pull_request_conversation
.github/workflows/ansible.molecule.fo.yml,7481412620,completed,failure,14122bb9139c03f5a02636ee50b6bade35df9f55,Fall back to commit count of 0 in TPv2,Zach Hoffman,2024-01-10T22:14:40Z,5,['experimental/traffic-portal/server.config.ts'],7896,Include commits since last release in RPM build number,zrhoffman,2024-01-09T20:58:15Z,"['documentation', 'cdn-in-a-box', 'build', 'Traffic Portal v2']","<!--
Thank you for contributing! Please be sure to read our contribution guidelines: https://github.com/apache/trafficcontrol/blob/master/CONTRIBUTING.md
If this closes or relates to an existing issue, please reference it using one of the following:

Closes: #ISSUE
Related: #ISSUE

If this PR fixes a security vulnerability, DO NOT submit! Instead, contact
the Apache Traffic Control Security Team at security@trafficcontrol.apache.org and follow the
guidelines at https://apache.org/security regarding vulnerability disclosure.
-->

This PR changes the build number to include the number of commits since the last release, rather than the total number of commits ever. Previously, the total commit count was used to ensure that a build from a later child commit will always be considered a higher version number.

But because the version number increases each time the release version increases, counting only the commits since the last release tag is sufficient.
<!-- **^ Add meaningful description above** --><hr/>

## Which Traffic Control components are affected by this PR?
<!-- Please delete all components from this list that are NOT affected by this PR.
Feel free to add the name of a tool or script that is affected but not on the list.
-->
- Documentation
- CDN in a Box
- Traffic Portal v2

## What is the best way to verify this PR?
<!-- Please include here ALL the steps necessary to test your PR.
If your PR has tests (and most should), provide the steps needed to run the tests.
If not, please provide step-by-step instructions to test the PR manually and explain why your PR does not need tests. -->
* Test `/about` TO API endpoint
* Make sure the *CDN-in-a-Box CI* GHA workflow picks up the already-built RPMs instead of rebuilding them all again.

## PR submission checklist
- [ ] This PR has tests <!-- If not, please delete this text and explain why this PR does not need tests. -->
- [x] This PR has documentation <!-- If not, please delete this text and explain why this PR does not need documentation. -->
- [x] This PR has a CHANGELOG.md entry <!-- A fix for a bug from an ATC release, an improvement, or a new feature should have a changelog entry. -->
- [x] This PR **DOES NOT FIX A SERIOUS SECURITY VULNERABILITY** (see [the Apache Software Foundation's security guidelines](https://apache.org/security) for details)

<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
""License""); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
""AS IS"" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
","[{'comment_body': ""It looks like either the Makefile changes aren't matching up with the changes elsewhere for some reason, or possibly there's a place where it needs to be changed that's currently being missed.\r\n```\r\ncp: cannot stat '../../dist/trafficcontrol-cache-config-8.1.0-.5310b010.el8.x86_64.rpm': No such file or directory\r\n```\r\n\r\nAlternatively, RPM package archive files are totally capable of containing this information - does that _**really**_ need to be in the filename, too? I know I've said this before, but it seems very redundant to me.""}, {'comment_body': ""> It looks like either the Makefile changes aren't matching up with the changes elsewhere for some reason, or possibly there's a place where it needs to be changed that's currently being missed.\r\n> \r\n> ```\r\n> cp: cannot stat '../../dist/trafficcontrol-cache-config-8.1.0-.5310b010.el8.x86_64.rpm': No such file or directory\r\n> ```\r\n\r\nFixed in f49cf08806 and 2262faf933\r\n\r\n> \r\n> Alternatively, RPM package archive files are totally capable of containing this information - does that _**really**_ need to be in the filename, too?\r\n\r\nYes so that RPMs are sorted in directories, first by version, then by release number.\r\n\r\n> I know I've said this before, but it seems very redundant to me.\r\n\r\nYes it is, but this PR isn't meant to change that. That's probably a bigger conversation that might get pushback from some people.\r\n""}, {'comment_body': ""I checked the build artifacts for the checks on this branch - specifically Traffic Ops - and found that it produced\r\n\r\n- `traffic_ops-8.1.0-0.d5e35540.el8.src.rpm`\r\n- `traffic_ops-8.1.0-0.d5e35540.el8.x86_64.rpm`\r\n\r\nso it looks like that's saying there have been zero commits since 8.1.0. That's incorrect not only because 8.1.0 doesn't technically exist (:P) but because this PR consists of a non-zero amount of commits.\r\n\r\ntl;dr we got a number now, but it's not the right number.""}, {'comment_body': ""> so it looks like that's saying there have been zero commits since 8.1.0. That's incorrect not only because 8.1.0 doesn't technically exist (:P)\r\n\r\nThat's the version in [VERSION](https://github.com/apache/trafficcontrol/blob/14122bb913/VERSION)\r\n\r\n> but because this PR consists of a non-zero amount of commits.\r\n> \r\n> tl;dr we got a number now, but it's not the right number.\r\n\r\nThe GitHub Actions only clone the repo with a `fetch-depth` of 5 commits. Because no tags matching the pattern are found within the 5 commits, it defaults to `0`. So `0` is expected, in this case.""}, {'comment_body': 'So was that always broken? Do we care if the build artifacts match what a user would build?'}, {'comment_body': '> So was that always broken?\r\n\r\nYes it was always broken, RPMs from CI outside this PR say include `5` as the commit count\r\n\r\n>  Do we care if the build artifacts match what a user would build?\r\n\r\nnah'}]"
